@{
    ViewBag.Title = "Usage Triggers";
}

<h1>When I Say Stop, You Stop</h1>
<p>This page demonstrates Usage Triggers.  There is a usage trigger tied to this account which fires each time the account receives three SMS messages.  When the usage trigger fires it updates this web page.</p>
    
<p>Try the sample by sending SMS messages to +1 240-428-6557.</p>

<h2>Usage Trigger Notifications</h2>

<ul></ul>

<p>@ViewBag.triggerState</p>


@section Scripts {

<script src="~/Scripts/jquery.signalR-1.1.3.js" type="text/javascript"></script>
<script src="~/signalr/hubs"></script>

<script>
    $(function () {
        $.connection.hub.logging = true;

        var hub = $.connection.triggerHub;

        hub.client.triggerNotification = function (usageTriggerSid, dateFired, usageCategory, triggerBy, triggerValue, currentUsageValue) {
            $("ul").append($('<li>').append('<span>[' + dateFired + '] ' + usageCategory + '( trigger value: ' + triggerValue + ' current value: ' + currentUsageValue + ' )</span>'));
        };

        $.connection.hub.start();
    });
</script>
}